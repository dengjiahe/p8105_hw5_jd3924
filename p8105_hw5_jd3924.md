p8105_hw5_jd3924
================
Jiahe Deng
2022-11-07

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.5 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.3      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
urlfile = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"
homicides_data = read_csv(url(urlfile), na = c(" ", "Unknown"))
```

    ## Warning: One or more parsing issues, call `problems()` on your data frame for details,
    ## e.g.:
    ##   dat <- vroom(...)
    ##   problems(dat)

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (8): uid, victim_last, victim_first, victim_race, victim_sex, city, stat...
    ## dbl (4): reported_date, victim_age, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

In this data, there is 52179 observations and 12 variables. This data
include each case’s detailed information, such as victim’s name age and
race,location, and the progress of the case.

``` r
homicides_data = 
  homicides_data %>%
  mutate(
    city_state = str_c(city,state, sep = ","),
    resolution = case_when(
      disposition == 'Closed without arrest' ~ 'unsolved',
      disposition == 'Open/No arrest' ~ 'unsolved',
      disposition == 'Closed by arrest' ~ 'solved'
         )) %>% relocate(city_state)
```

``` r
homicides_data %>%
  group_by(city_state) %>%
  summarize(
    number_of_unsolved = sum(resolution == "unsolved"),
    number_of_homicides = n())
```

    ## # A tibble: 51 × 3
    ##    city_state     number_of_unsolved number_of_homicides
    ##    <chr>                       <int>               <int>
    ##  1 Albuquerque,NM                146                 378
    ##  2 Atlanta,GA                    373                 973
    ##  3 Baltimore,MD                 1825                2827
    ##  4 Baton Rouge,LA                196                 424
    ##  5 Birmingham,AL                 347                 800
    ##  6 Boston,MA                     310                 614
    ##  7 Buffalo,NY                    319                 521
    ##  8 Charlotte,NC                  206                 687
    ##  9 Chicago,IL                   4073                5535
    ## 10 Cincinnati,OH                 309                 694
    ## # … with 41 more rows

``` r
baltimore_data = 
  homicides_data %>%
  filter(city_state == "Baltimore,MD")

baltimore_summary = 
  baltimore_data %>%
  summarise(
    unsolved_md = sum(resolution == "unsolved"),
    num = n())

prop.test(
  x = baltimore_summary %>% pull(unsolved_md),
  n = baltimore_summary %>% pull(num)
  ) %>%
  broom::tidy()
```

    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method        alter…¹
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>         <chr>  
    ## 1    0.646      239. 6.46e-54         1    0.628     0.663 1-sample pro… two.si…
    ## # … with abbreviated variable name ¹​alternative

``` r
prop_test = function(city){
  
  city_summary = 
    city %>% 
      summarise(
        unsolved = sum(resolution == 'unsolved'),
        n = n()
      )
  
  city_test = 
    prop.test(
      x = city_summary %>% pull(unsolved),
      n = city_summary %>% pull(n)
    )
  
  city_test
}
```

``` r
#use Baltimore to test whether the function works propertly
prop_test(baltimore_data)
```

    ## 
    ##  1-sample proportions test with continuity correction
    ## 
    ## data:  city_summary %>% pull(unsolved) out of city_summary %>% pull(n), null probability 0.5
    ## X-squared = 239.01, df = 1, p-value < 2.2e-16
    ## alternative hypothesis: true p is not equal to 0.5
    ## 95 percent confidence interval:
    ##  0.6275625 0.6631599
    ## sample estimates:
    ##         p 
    ## 0.6455607

``` r
#Conduct a hypothesis T test for n = 30, sigma = 5
sim_funct = function( 
    n = 30, 
    mu = 0,
    sigma = 5) {
  x = rnorm(n, mean = mu, sd = sigma)
  t_test = t.test(x, conf.int = 0.95) %>% broom::tidy()
  
  t_test
}
output = vector("list",5000) #Generate 5000 datasets for mu=0
for (i in 1: 5000) {
  output[[i]] = sim_funct()
}
output %>% bind_rows()
```

    ## # A tibble: 5,000 × 8
    ##    estimate statistic p.value parameter conf.low conf.high method        alter…¹
    ##       <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl> <chr>         <chr>  
    ##  1   0.771     0.762    0.452        29   -1.30      2.84  One Sample t… two.si…
    ##  2  -0.728    -0.903    0.374        29   -2.38      0.920 One Sample t… two.si…
    ##  3  -0.580    -0.672    0.507        29   -2.35      1.19  One Sample t… two.si…
    ##  4   0.294     0.287    0.776        29   -1.80      2.39  One Sample t… two.si…
    ##  5   0.701     0.887    0.382        29   -0.916     2.32  One Sample t… two.si…
    ##  6   0.136     0.182    0.857        29   -1.40      1.67  One Sample t… two.si…
    ##  7   1.63      1.60     0.121        29   -0.455     3.71  One Sample t… two.si…
    ##  8   0.0839    0.0855   0.932        29   -1.92      2.09  One Sample t… two.si…
    ##  9   0.970     0.914    0.368        29   -1.20      3.14  One Sample t… two.si…
    ## 10  -1.44     -1.44     0.161        29   -3.49      0.606 One Sample t… two.si…
    ## # … with 4,990 more rows, and abbreviated variable name ¹​alternative

``` r
#mu={1,2,3,4,5,6}
```
