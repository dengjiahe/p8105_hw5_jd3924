p8105_hw5_jd3924
================
Jiahe Deng
2022-11-07

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.5 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.3      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
urlfile = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"
homicides_data = read_csv(url(urlfile), na = c(" ", "Unknown"))
```

    ## Warning: One or more parsing issues, call `problems()` on your data frame for details,
    ## e.g.:
    ##   dat <- vroom(...)
    ##   problems(dat)

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (8): uid, victim_last, victim_first, victim_race, victim_sex, city, stat...
    ## dbl (4): reported_date, victim_age, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

In this data, there is 52179 observations and 12 variables. This data
include each case’s detailed information, such as victim’s name age and
race,location, and the progress of the case.

``` r
homicides_data = 
  homicides_data %>%
  mutate(
    city_state = str_c(city,state, sep = ","),
    resolution = case_when(
      disposition == 'Closed without arrest' ~ 'unsolved',
      disposition == 'Open/No arrest' ~ 'unsolved',
      disposition == 'Closed by arrest' ~ 'solved'
         )) %>% relocate(city_state)
```

``` r
homicides_data %>%
  group_by(city_state) %>%
  summarize(
    number_of_unsolved = sum(resolution == "unsolved"),
    number_of_homicides = n())
```

    ## # A tibble: 51 × 3
    ##    city_state     number_of_unsolved number_of_homicides
    ##    <chr>                       <int>               <int>
    ##  1 Albuquerque,NM                146                 378
    ##  2 Atlanta,GA                    373                 973
    ##  3 Baltimore,MD                 1825                2827
    ##  4 Baton Rouge,LA                196                 424
    ##  5 Birmingham,AL                 347                 800
    ##  6 Boston,MA                     310                 614
    ##  7 Buffalo,NY                    319                 521
    ##  8 Charlotte,NC                  206                 687
    ##  9 Chicago,IL                   4073                5535
    ## 10 Cincinnati,OH                 309                 694
    ## # … with 41 more rows

``` r
baltimore_data = 
  homicides_data %>%
  filter(city_state == "Baltimore,MD")

baltimore_summary = 
  baltimore_data %>%
  summarise(
    unsolved_md = sum(resolution == "unsolved"),
    num = n())

prop.test(
  x = baltimore_summary %>% pull(unsolved_md),
  n = baltimore_summary %>% pull(num)
  ) %>%
  broom::tidy()
```

    ## # A tibble: 1 × 8
    ##   estimate statistic  p.value parameter conf.low conf.high method        alter…¹
    ##      <dbl>     <dbl>    <dbl>     <int>    <dbl>     <dbl> <chr>         <chr>  
    ## 1    0.646      239. 6.46e-54         1    0.628     0.663 1-sample pro… two.si…
    ## # … with abbreviated variable name ¹​alternative

``` r
#Conduct a hypothesis T test for n = 30, sigma = 5
sim_funct = function( 
    n = 30, 
    mu = 0,
    sigma = 5) {
  x = rnorm(n, mean = mu, sd = sigma)
  t_test = t.test(x, conf.int = 0.95) %>% broom::tidy()
  
  t_test
}
output = vector("list",5000) #Generate 5000 datasets for mu=0
for (i in 1: 5000) {
  output[[i]] = sim_funct()
}
output %>% bind_rows()
```

    ## # A tibble: 5,000 × 8
    ##    estimate statistic p.value parameter conf.low conf.high method        alter…¹
    ##       <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl> <chr>         <chr>  
    ##  1   0.841     0.739   0.466         29   -1.49     3.17   One Sample t… two.si…
    ##  2  -1.51     -1.49    0.148         29   -3.59     0.569  One Sample t… two.si…
    ##  3   0.270     0.324   0.749         29   -1.44     1.98   One Sample t… two.si…
    ##  4   0.283     0.319   0.752         29   -1.53     2.10   One Sample t… two.si…
    ##  5   0.933     1.06    0.296         29   -0.859    2.72   One Sample t… two.si…
    ##  6   1.20      1.74    0.0921        29   -0.209    2.62   One Sample t… two.si…
    ##  7  -2.08     -2.00    0.0546        29   -4.21     0.0443 One Sample t… two.si…
    ##  8  -0.0256   -0.0278  0.978         29   -1.91     1.86   One Sample t… two.si…
    ##  9  -1.11     -1.26    0.217         29   -2.92     0.693  One Sample t… two.si…
    ## 10   0.499     0.620   0.540         29   -1.15     2.15   One Sample t… two.si…
    ## # … with 4,990 more rows, and abbreviated variable name ¹​alternative

``` r
#mu={1,2,3,4,5,6}
```
