---
title: "p8105_hw5_jd3924"
author: "Jiahe Deng"
date: "2022-11-07"
output: github_document
---

```{r}
library(tidyverse)
```

```{r}
urlfile = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"
homicides_data = read_csv(url(urlfile), na = c(" ", "Unknown"))
```
In this data, there is 52179 observations and 12 variables.
This data include each case's detailed information, such as victim's name age and race,location, and the progress of the case.
```{r}
homicides_data = 
  homicides_data %>%
  mutate(
    city_state = str_c(city,state, sep = ","),
    resolution = case_when(
      disposition == 'Closed without arrest' ~ 'unsolved',
      disposition == 'Open/No arrest' ~ 'unsolved',
      disposition == 'Closed by arrest' ~ 'solved'
         )) %>% relocate(city_state)
```
```{r}
homicides_data %>%
  group_by(city_state) %>%
  summarize(
    number_of_unsolved = sum(resolution == "unsolved"),
    number_of_homicides = n())
```



```{r}
#Conduct a hypothesis T test for n = 30, sigma = 5
sim_funct = function( 
    n = 30, 
    mu = 0,
    sigma = 5) {
  x = rnorm(n, mean = mu, sd = sigma)
  t_test = t.test(x, conf.int = 0.95) %>% broom::tidy()
  
  t_test
}
output = vector("list",5000) #Generate 5000 datasets for mu=0
for (i in 1: 5000) {
  output[[i]] = sim_funct()
}
output %>% bind_rows()
```

```{r}
#mu={1,2,3,4,5,6}
```

